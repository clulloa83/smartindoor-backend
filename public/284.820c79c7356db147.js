(self.webpackChunkapp=self.webpackChunkapp||[]).push([[284,1764,7379,7276],{284:(q,Y,g)=>{"use strict";g.r(Y),g.d(Y,{ProgramaPageModule:()=>F});var C=g(6895),p=g(4719),h=g(1558),S=g(2507),O=g(5861),P=g(1764),N=g(6582),D=g(9337),t=g(6353),Z=g(8077),A=g(9498),I=g(8555),G=g(5970);function Q(l,d){if(1&l&&(t.TgZ(0,"div",12)(1,"label"),t._UZ(2,"input",13),t._uU(3),t.qZA()()),2&l){const n=d.$implicit;t.xp6(2),t.s9C("value",n.id),t.xp6(1),t.hij("",n.id," ")}}function W(l,d){if(1&l&&(t.TgZ(0,"ion-item")(1,"ion-label"),t._uU(2),t.qZA(),t._UZ(3,"ion-checkbox",20),t.qZA()),2&l){const n=d.index,f=t.oxw(2);t.xp6(2),t.Oqu(f.dias[n].id),t.xp6(1),t.Q6J("formControlName",n)}}function U(l,d){if(1&l){const n=t.EpF();t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",1)(3,"ion-button",14),t.NdJ("click",function(){t.CHM(n);const $=t.oxw();return t.KtG($.cancel())}),t._uU(4,"Cancelar"),t.qZA()(),t.TgZ(5,"ion-title",0),t._uU(6,"Repetir"),t.qZA(),t.TgZ(7,"ion-buttons",15)(8,"ion-button",16),t.NdJ("click",function(){t.CHM(n);const $=t.oxw();return t.KtG($.confirm())}),t._uU(9,"Confirmar"),t.qZA()()()(),t.TgZ(10,"ion-content",17),t.ynx(11,18),t.YNc(12,W,4,2,"ion-item",19),t.BQk(),t.qZA()}if(2&l){const n=t.oxw();t.xp6(8),t.Q6J("strong",!0),t.xp6(4),t.Q6J("ngForOf",n.diasFormArray.controls)}}const x=[{path:"",component:(()=>{class l{constructor(n,f,$,u,r,i){var a=this;this.programaService=n,this.actRoute=f,this.Navparams=$,this.loaderService=u,this.alertService=r,this.router=i,this.acciones=[{id:"ENCENDIDO",checked:!0},{id:"APAGADO",checked:!1}],this.dias=[{id:"Lun",checked:!1},{id:"Mar",checked:!1},{id:"Mie",checked:!1},{id:"Jue",checked:!1},{id:"Vie",checked:!1},{id:"Sab",checked:!1},{id:"Dom",checked:!1}],this.inicializar=()=>{const e=P(new Date,"YYYY-MM-DD").format();this.id=this.actRoute.snapshot.paramMap.get("id"),this.dispositivoId=this.Navparams.getData(),this.form=new p.cw({hora:new p.NI(e,p.kI.required),accion:new p.NI("",p.kI.required),dias:new p.Oe([])}),this.dias.forEach(o=>{this.diasFormArray.push(new p.NI(o.checked))}),this.form.patchValue({accion:this.acciones.find(o=>!0===o.checked).id})},this.diasObtener=()=>(this.dias.forEach(e=>{e.checked=!1}),this.dias.map(e=>e.checked)),this.cancel=()=>{const e=this.diasObtener();this.form.patchValue({dias:e}),this.modal.dismiss(null,"cancel")},this.confirm=()=>{this.modal.dismiss(null,"confirm")},this.guardarPrograma=(0,O.Z)(function*(){const e=a.form.value.dias.map((s,c)=>s?a.dias[c].id:null).filter(s=>null!==s),o=new N.i;o.dispositivo.id=a.dispositivoId,o.accion=a.form.value.accion,o.hora=P(a.form.value.hora).format("HH:mm"),o.dias=e;try{yield a.loaderService.simpleLoader("cargando"),yield a.programaService.programaGuardar(o),yield a.loaderService.dismissLoader(),yield a.router.navigate([`programas/${a.dispositivoId}`])}catch(s){console.log("guardarPrograma error",s),a.loaderService.dismissLoader();const c=new D.b;c.header="Error al guardar programa",c.message="Se ha producido un error, favor intentar m\xe1s tarde",c.buttons=["OK"],a.alertService.simpleAlert(c)}}),this.inicializar()}get diasFormArray(){return this.form.controls.dias}get repetirDias(){const n=this.form.value.dias.map((f,$)=>f?this.dias[$].id:null).filter(f=>null!==f);return n.length<1?"Una vez":n.length==this.dias.length?"Cada d\xeda":n}onWillDismiss(n){if("backdrop"===n.detail.role){const $=this.diasObtener();this.form.patchValue({dias:$})}}}return l.\u0275fac=function(n){return new(n||l)(t.Y36(Z.$),t.Y36(S.gz),t.Y36(A.a),t.Y36(I.D),t.Y36(G.c),t.Y36(S.F0))},l.\u0275cmp=t.Xpm({type:l,selectors:[["app-programa"]],viewQuery:function(n,f){if(1&n&&t.Gf(h.ki,5),2&n){let $;t.iGM($=t.CRH())&&(f.modal=$.first)}},decls:29,vars:4,consts:[[1,"ion-text-center"],["slot","start"],["defaultHref","programas","text",""],[3,"formGroup","ngSubmit"],["lines","full"],["position","fixed"],["slot","end","formControlName","hora","presentation","time"],["class","radio",4,"ngFor","ngForOf"],["id","open-modal","slot","end"],["slot","icon-only","name","add-outline"],["trigger","open-modal",3,"willDismiss"],["type","submit","color","primary","expand","block",3,"disabled"],[1,"radio"],["type","radio","formControlName","accion",3,"value"],[3,"click"],["slot","end"],[3,"strong","click"],[1,"ion-padding"],["formArrayName","dias"],[4,"ngFor","ngForOf"],["slot","start",3,"formControlName"]],template:function(n,f){1&n&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title",0),t._uU(3,"Programa"),t.qZA(),t.TgZ(4,"ion-buttons",1),t._UZ(5,"ion-back-button",2),t.qZA()()(),t.TgZ(6,"ion-content")(7,"form",3),t.NdJ("ngSubmit",function(){return f.guardarPrograma()}),t.TgZ(8,"ion-item",4)(9,"ion-label",5),t._uU(10,"Hora"),t.qZA(),t._UZ(11,"ion-datetime",6),t.qZA(),t.TgZ(12,"ion-item",4)(13,"ion-label",5),t._uU(14,"Acci\xf3n"),t.qZA(),t.YNc(15,Q,4,2,"div",7),t.qZA(),t.TgZ(16,"ion-item",4)(17,"ion-label",5),t._uU(18,"Repetir"),t.qZA(),t.TgZ(19,"ion-label"),t._uU(20),t.qZA(),t.TgZ(21,"ion-button",8),t._UZ(22,"ion-icon",9),t.qZA(),t.TgZ(23,"ion-modal",10),t.NdJ("willDismiss",function(u){return f.onWillDismiss(u)}),t.YNc(24,U,13,2,"ng-template"),t.qZA()(),t.TgZ(25,"ion-row")(26,"ion-col")(27,"ion-button",11),t._uU(28,"Guardar"),t.qZA()()()()()),2&n&&(t.xp6(7),t.Q6J("formGroup",f.form),t.xp6(8),t.Q6J("ngForOf",f.acciones),t.xp6(5),t.Oqu(f.repetirDias),t.xp6(7),t.Q6J("disabled",!f.form.valid))},dependencies:[C.sg,p._Y,p.Fj,p._,p.JJ,p.JL,h.oU,h.YG,h.Sm,h.nz,h.wI,h.W2,h.x4,h.Gu,h.gu,h.Ie,h.Q$,h.ki,h.Nd,h.sr,h.wd,h.w,h.QI,h.cs,p.sg,p.u,p.CE]}),l})()}];let w=(()=>{class l{}return l.\u0275fac=function(n){return new(n||l)},l.\u0275mod=t.oAB({type:l}),l.\u0275inj=t.cJS({imports:[S.Bz.forChild(x),S.Bz]}),l})(),F=(()=>{class l{}return l.\u0275fac=function(n){return new(n||l)},l.\u0275mod=t.oAB({type:l}),l.\u0275inj=t.cJS({imports:[C.ez,p.u5,h.Pc,w,p.UX]}),l})()},1764:function(q){q.exports=function(){"use strict";var g=6e4,C=36e5,p="millisecond",h="second",S="minute",O="hour",P="day",N="week",D="month",t="quarter",Z="year",A="date",I="Invalid Date",G=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,Q=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,W={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},U=function(u,r,i){var a=String(u);return!a||a.length>=r?u:""+Array(r+1-a.length).join(i)+u},j={s:U,z:function(u){var r=-u.utcOffset(),i=Math.abs(r),a=Math.floor(i/60),e=i%60;return(r<=0?"+":"-")+U(a,2,"0")+":"+U(e,2,"0")},m:function u(r,i){if(r.date()<i.date())return-u(i,r);var a=12*(i.year()-r.year())+(i.month()-r.month()),e=r.clone().add(a,D),o=i-e<0,s=r.clone().add(a+(o?-1:1),D);return+(-(a+(i-e)/(o?e-s:s-e))||0)},a:function(u){return u<0?Math.ceil(u)||0:Math.floor(u)},p:function(u){return{M:D,y:Z,w:N,d:P,D:A,h:O,m:S,s:h,ms:p,Q:t}[u]||String(u||"").toLowerCase().replace(/s$/,"")},u:function(u){return void 0===u}},x="en",w={};w[x]=W;var F=function(u){return u instanceof f},l=function u(r,i,a){var e;if(!r)return x;if("string"==typeof r){var o=r.toLowerCase();w[o]&&(e=o),i&&(w[o]=i,e=o);var s=r.split("-");if(!e&&s.length>1)return u(s[0])}else{var c=r.name;w[c]=r,e=c}return!a&&e&&(x=e),e||!a&&x},d=function(u,r){if(F(u))return u.clone();var i="object"==typeof r?r:{};return i.date=u,i.args=arguments,new f(i)},n=j;n.l=l,n.i=F,n.w=function(u,r){return d(u,{locale:r.$L,utc:r.$u,x:r.$x,$offset:r.$offset})};var f=function(){function u(i){this.$L=l(i.locale,null,!0),this.parse(i)}var r=u.prototype;return r.parse=function(i){this.$d=function(a){var e=a.date,o=a.utc;if(null===e)return new Date(NaN);if(n.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var s=e.match(G);if(s){var c=s[2]-1||0,v=(s[7]||"0").substring(0,3);return o?new Date(Date.UTC(s[1],c,s[3]||1,s[4]||0,s[5]||0,s[6]||0,v)):new Date(s[1],c,s[3]||1,s[4]||0,s[5]||0,s[6]||0,v)}}return new Date(e)}(i),this.$x=i.x||{},this.init()},r.init=function(){var i=this.$d;this.$y=i.getFullYear(),this.$M=i.getMonth(),this.$D=i.getDate(),this.$W=i.getDay(),this.$H=i.getHours(),this.$m=i.getMinutes(),this.$s=i.getSeconds(),this.$ms=i.getMilliseconds()},r.$utils=function(){return n},r.isValid=function(){return this.$d.toString()!==I},r.isSame=function(i,a){var e=d(i);return this.startOf(a)<=e&&e<=this.endOf(a)},r.isAfter=function(i,a){return d(i)<this.startOf(a)},r.isBefore=function(i,a){return this.endOf(a)<d(i)},r.$g=function(i,a,e){return n.u(i)?this[a]:this.set(e,i)},r.unix=function(){return Math.floor(this.valueOf()/1e3)},r.valueOf=function(){return this.$d.getTime()},r.startOf=function(i,a){var e=this,o=!!n.u(a)||a,s=n.p(i),c=function(k,M){var _=n.w(e.$u?Date.UTC(e.$y,M,k):new Date(e.$y,M,k),e);return o?_:_.endOf(P)},v=function(k,M){return n.w(e.toDate()[k].apply(e.toDate("s"),(o?[0,0,0,0]:[23,59,59,999]).slice(M)),e)},m=this.$W,y=this.$M,b=this.$D,T="set"+(this.$u?"UTC":"");switch(s){case Z:return o?c(1,0):c(31,11);case D:return o?c(1,y):c(0,y+1);case N:var J=this.$locale().weekStart||0,H=(m<J?m+7:m)-J;return c(o?b-H:b+(6-H),y);case P:case A:return v(T+"Hours",0);case O:return v(T+"Minutes",1);case S:return v(T+"Seconds",2);case h:return v(T+"Milliseconds",3);default:return this.clone()}},r.endOf=function(i){return this.startOf(i,!1)},r.$set=function(i,a){var e,o=n.p(i),s="set"+(this.$u?"UTC":""),c=(e={},e[P]=s+"Date",e[A]=s+"Date",e[D]=s+"Month",e[Z]=s+"FullYear",e[O]=s+"Hours",e[S]=s+"Minutes",e[h]=s+"Seconds",e[p]=s+"Milliseconds",e)[o],v=o===P?this.$D+(a-this.$W):a;if(o===D||o===Z){var m=this.clone().set(A,1);m.$d[c](v),m.init(),this.$d=m.set(A,Math.min(this.$D,m.daysInMonth())).$d}else c&&this.$d[c](v);return this.init(),this},r.set=function(i,a){return this.clone().$set(i,a)},r.get=function(i){return this[n.p(i)]()},r.add=function(i,a){var e,o=this;i=Number(i);var s=n.p(a),c=function(y){var b=d(o);return n.w(b.date(b.date()+Math.round(y*i)),o)};if(s===D)return this.set(D,this.$M+i);if(s===Z)return this.set(Z,this.$y+i);if(s===P)return c(1);if(s===N)return c(7);var v=(e={},e[S]=g,e[O]=C,e[h]=1e3,e)[s]||1,m=this.$d.getTime()+i*v;return n.w(m,this)},r.subtract=function(i,a){return this.add(-1*i,a)},r.format=function(i){var a=this,e=this.$locale();if(!this.isValid())return e.invalidDate||I;var o=i||"YYYY-MM-DDTHH:mm:ssZ",s=n.z(this),c=this.$H,v=this.$m,m=this.$M,y=e.weekdays,b=e.months,T=function(M,_,z,L){return M&&(M[_]||M(a,o))||z[_].slice(0,L)},J=function(M){return n.s(c%12||12,M,"0")},H=e.meridiem||function(M,_,z){var L=M<12?"AM":"PM";return z?L.toLowerCase():L},k={YY:String(this.$y).slice(-2),YYYY:this.$y,M:m+1,MM:n.s(m+1,2,"0"),MMM:T(e.monthsShort,m,b,3),MMMM:T(b,m),D:this.$D,DD:n.s(this.$D,2,"0"),d:String(this.$W),dd:T(e.weekdaysMin,this.$W,y,2),ddd:T(e.weekdaysShort,this.$W,y,3),dddd:y[this.$W],H:String(c),HH:n.s(c,2,"0"),h:J(1),hh:J(2),a:H(c,v,!0),A:H(c,v,!1),m:String(v),mm:n.s(v,2,"0"),s:String(this.$s),ss:n.s(this.$s,2,"0"),SSS:n.s(this.$ms,3,"0"),Z:s};return o.replace(Q,function(M,_){return _||k[M]||s.replace(":","")})},r.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},r.diff=function(i,a,e){var o,s=n.p(a),c=d(i),v=(c.utcOffset()-this.utcOffset())*g,m=this-c,y=n.m(this,c);return y=(o={},o[Z]=y/12,o[D]=y,o[t]=y/3,o[N]=(m-v)/6048e5,o[P]=(m-v)/864e5,o[O]=m/C,o[S]=m/g,o[h]=m/1e3,o)[s]||m,e?y:n.a(y)},r.daysInMonth=function(){return this.endOf(D).$D},r.$locale=function(){return w[this.$L]},r.locale=function(i,a){if(!i)return this.$L;var e=this.clone(),o=l(i,a,!0);return o&&(e.$L=o),e},r.clone=function(){return n.w(this.$d,this)},r.toDate=function(){return new Date(this.valueOf())},r.toJSON=function(){return this.isValid()?this.toISOString():null},r.toISOString=function(){return this.$d.toISOString()},r.toString=function(){return this.$d.toUTCString()},u}(),$=f.prototype;return d.prototype=$,[["$ms",p],["$s",h],["$m",S],["$H",O],["$W",P],["$M",D],["$y",Z],["$D",A]].forEach(function(u){$[u[1]]=function(r){return this.$g(r,u[0],u[1])}}),d.extend=function(u,r){return u.$i||(u(r,f,d),u.$i=!0),d},d.locale=l,d.isDayjs=F,d.unix=function(u){return d(1e3*u)},d.en=w[x],d.Ls=w,d.p={},d}()}}]);